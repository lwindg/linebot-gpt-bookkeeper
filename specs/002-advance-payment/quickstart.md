# Quickstart: v1.7 ä»£å¢Šèˆ‡éœ€æ”¯ä»˜åŠŸèƒ½å¯¦ä½œæŒ‡å—

**æ—¥æœŸ**ï¼š2025-11-18
**é©ç”¨å°è±¡**ï¼šé–‹ç™¼è€…ï¼ˆClaude AI æˆ–äººé¡ï¼‰
**é ä¼°æ™‚é–“**ï¼š2-3 å°æ™‚ï¼ˆå«æ¸¬è©¦ï¼‰

## æ¦‚è¿°

æœ¬æŒ‡å—æä¾› v1.7 ä»£å¢ŠåŠŸèƒ½çš„å¯¦ä½œæ­¥é©Ÿã€‚åŸºæ–¼ research.md çš„æ±ºç­–ï¼Œæˆ‘å€‘æ¡ç”¨**æœ€å°è®Šæ›´ç­–ç•¥**ï¼š
- âœ… é‡ç”¨ç¾æœ‰è³‡æ–™æ¨¡å‹ï¼ˆç„¡ schema è®Šæ›´ï¼‰
- âœ… å¢å¼· GPT promptï¼ˆæ–°å¢ ADVANCE_PAYMENT_RULESï¼‰
- âœ… æ›´æ–° LINE ç¢ºèªè¨Šæ¯æ ¼å¼ï¼ˆæ¢ä»¶é¡¯ç¤ºä»£å¢Šè³‡è¨Šï¼‰
- âœ… ç„¡æ–°ä¾è³´ï¼Œç„¡æ–°æª”æ¡ˆ

## å‰ç½®éœ€æ±‚

- âœ… Python 3.11+ ç’°å¢ƒ
- âœ… å·²å®‰è£ä¾è³´ï¼ˆrequirements.txtï¼‰
- âœ… ç†Ÿæ‚‰ v1.5.0 å¤šé …ç›®è¨˜å¸³æ¶æ§‹
- âœ… å¯å­˜å– GPT-4o API

## å¯¦ä½œæ­¥é©Ÿ

### Step 1: å¢å¼· GPT Promptï¼ˆapp/prompts.pyï¼‰

**ç›®æ¨™**ï¼šæ–°å¢ä»£å¢Šç‹€æ…‹è­˜åˆ¥è¦å‰‡ï¼Œä½¿ GPT èƒ½å¾è‡ªç„¶èªè¨€ä¸­æå–ä»£å¢Šè³‡è¨Šã€‚

#### 1.1 æ–°å¢ ADVANCE_PAYMENT_RULES å¸¸æ•¸

åœ¨ `app/prompts.py` çš„å…±ç”¨è¦å‰‡å®šç¾©å€å¡Šï¼ˆèˆ‡ `PAYMENT_METHODS` åŒå±¤ï¼‰ï¼Œæ–°å¢ï¼š

```python
ADVANCE_PAYMENT_RULES = """## ä»£å¢Šç‹€æ…‹è­˜åˆ¥

æ ¹æ“šè¨Šæ¯é—œéµå­—åˆ¤æ–·ä»£å¢Šç‹€æ…‹ï¼Œä¸¦æå–æ”¶æ¬¾ï¼æ”¯ä»˜å°è±¡ã€‚

### é—œéµå­—å°ç…§è¡¨

| ä»£å¢Šç‹€æ…‹ | é—œéµå­— | ç¯„ä¾‹è¨Šæ¯ |
|---------|-------|---------|
| **ä»£å¢Š** | å¥é¦–ã€Œä»£ã€ã€ã€Œå¹«ã€+å°è±¡ | ä»£å¦¹è²·ã€å¹«åŒäº‹å¢Šä»˜ |
| **éœ€æ”¯ä»˜** | å°è±¡+ã€Œä»£è¨‚ã€ã€ã€Œå¹«æˆ‘è²·ã€ | å¼Ÿä»£è¨‚ã€æœ‹å‹å¹«æˆ‘è²· |
| **ä¸ç´¢å–** | ã€Œä¸ç”¨é‚„ã€ã€ã€Œä¸ç´¢å–ã€ã€ã€Œé€çµ¦ã€ | å¹«åª½è²·ï¼Œä¸ç”¨é‚„ |
| **ç„¡** | ç„¡ä»£å¢Šé—œéµå­— | åˆé¤120å…ƒç¾é‡‘ |

### æå–å°è±¡è¦å‰‡

å¾è¨Šæ¯ä¸­æå–æ”¶æ¬¾æˆ–æ”¯ä»˜å°è±¡åç¨±ï¼š
- ã€Œä»£**å¦¹**è²·ã€â†’ å°è±¡ï¼š`"å¦¹"`
- ã€Œå¹«**åŒäº‹**å¢Šã€â†’ å°è±¡ï¼š`"åŒäº‹"`
- ã€Œ**å¼Ÿ**ä»£è¨‚ã€â†’ å°è±¡ï¼š`"å¼Ÿ"`
- ã€Œ**æœ‹å‹**å¹«æˆ‘è²·ã€â†’ å°è±¡ï¼š`"æœ‹å‹"`

### åˆ¤æ–·å„ªå…ˆé †åº

ç•¶è¨Šæ¯æ¨¡ç³Šæ™‚ï¼ŒæŒ‰ä»¥ä¸‹é †åºåˆ¤æ–·ï¼š
1. åŒ…å«ã€Œä¸ç”¨é‚„ã€ã€ã€Œä¸ç´¢å–ã€â†’ **ä¸ç´¢å–**ï¼ˆå„ªå…ˆç´šæœ€é«˜ï¼‰
2. å¥é¦–ç‚ºã€Œä»£ã€ã€ã€Œå¹«ã€â†’ **ä»£å¢Š**
3. å¥é¦–ç‚ºå°è±¡+ã€Œä»£ã€ã€ã€Œå¹«ã€â†’ **éœ€æ”¯ä»˜**
4. ç„¡é—œéµå­— â†’ **ç„¡**

### ä»˜æ¬¾æ–¹å¼é è¨­è¦å‰‡

- **ä»£å¢Š**é …ç›®ï¼šä½¿ç”¨è¨Šæ¯ä¸­çš„ä»˜æ¬¾æ–¹å¼ï¼ˆå¦‚ã€Œç¾é‡‘ã€ã€ã€Œåˆ·å¡ã€ï¼‰
- **éœ€æ”¯ä»˜**é …ç›®ï¼šè‹¥è¨Šæ¯æœªèªªæ˜ä»˜æ¬¾æ–¹å¼ â†’ é è¨­ `"NA"`ï¼ˆå› ä»–äººä»£ä»˜ï¼Œæœ¬äººå°šæœªæ”¯ä»˜ï¼‰
- **ä¸ç´¢å–**é …ç›®ï¼šä½¿ç”¨è¨Šæ¯ä¸­çš„ä»˜æ¬¾æ–¹å¼

### é©—è­‰è¦å‰‡

- è‹¥ä»£å¢Šç‹€æ…‹ç‚ºã€Œä»£å¢Šã€ã€ã€Œéœ€æ”¯ä»˜ã€ã€ã€Œä¸ç´¢å–ã€ï¼Œ**å¿…é ˆåŒ…å«æ”¶æ¬¾ï¼æ”¯ä»˜å°è±¡**
- è‹¥ç¼ºå°‘å°è±¡ â†’ å›å‚³ `error` intentï¼šã€Œè«‹æä¾›æ”¶æ¬¾å°è±¡è³‡è¨Šï¼ˆä¾‹å¦‚ï¼šå¹«èª°ä»£å¢Šï¼Ÿï¼‰ã€
"""
```

#### 1.2 æ•´åˆåˆ° MULTI_EXPENSE_PROMPT

åœ¨ `MULTI_EXPENSE_PROMPT` çš„è¼¸å‡ºæ ¼å¼å€å¡Šå‰ï¼Œæ’å…¥ä»£å¢Šè¦å‰‡ï¼š

```python
MULTI_EXPENSE_PROMPT = f"""ä½ æ˜¯å°ˆæ¥­çš„è¨˜å¸³åŠ©æ‰‹ï¼Œå”åŠ©ä½¿ç”¨è€…è¨˜éŒ„æ—¥å¸¸é–‹æ”¯ã€‚

...ï¼ˆç¾æœ‰å…§å®¹ä¿æŒä¸è®Šï¼‰...

{PAYMENT_METHODS}

{CLASSIFICATION_RULES}

{NECESSITY_LEVELS}

{ADVANCE_PAYMENT_RULES}  # â­ æ–°å¢æ­¤è¡Œ

## è¼¸å‡ºæ ¼å¼

...ï¼ˆç¾æœ‰è¼¸å‡ºæ ¼å¼ä¿æŒä¸è®Šï¼Œæ–°å¢ä»£å¢Šæ¬„ä½ç¯„ä¾‹ï¼‰...
```

#### 1.3 æ›´æ–°è¼¸å‡ºæ ¼å¼ç¯„ä¾‹

åœ¨ `MULTI_EXPENSE_PROMPT` çš„è¼¸å‡ºæ ¼å¼å€å¡Šï¼Œæ–°å¢ä»£å¢Šæ¬„ä½ç¯„ä¾‹ï¼š

```python
### å¤šé …è¨˜å¸³ï¼ˆå…±ç”¨ä»˜æ¬¾æ–¹å¼ï¼‰

ç¯„ä¾‹ 1ï¼šåŸºæœ¬å¤šé …ç›®ï¼ˆå«ä»£å¢Šï¼‰
```json
{{
  "intent": "multi_bookkeeping",
  "payment_method": "ç¾é‡‘",
  "items": [
    {{
      "å“é …": "æ—©é¤",
      "åŸå¹£é‡‘é¡": 80,
      "åˆ†é¡": "å®¶åº­ï¼é¤é£²ï¼æ—©é¤",
      "å¿…è¦æ€§": "å¿…è¦æ—¥å¸¸æ”¯å‡º",
      "ä»£å¢Šç‹€æ…‹": "ç„¡",           // â­ æ–°å¢
      "æ”¶æ¬¾æ”¯ä»˜å°è±¡": ""          // â­ æ–°å¢ï¼ˆä»£å¢Šç‹€æ…‹ç‚ºã€Œç„¡ã€æ™‚ç‚ºç©ºï¼‰
    }},
    {{
      "å“é …": "åˆé¤",
      "åŸå¹£é‡‘é¡": 150,
      "åˆ†é¡": "å€‹äººï¼é¤é£²",
      "å¿…è¦æ€§": "å¿…è¦æ—¥å¸¸æ”¯å‡º",
      "ä»£å¢Šç‹€æ…‹": "ä»£å¢Š",         // â­ æ–°å¢
      "æ”¶æ¬¾æ”¯ä»˜å°è±¡": "åŒäº‹"      // â­ æ–°å¢
    }}
  ]
}}
```
...ï¼ˆå…¶ä»–ç¯„ä¾‹åŒç†æ›´æ–°ï¼‰...
```

**é‡è¦æé†’**ï¼š
- âœ… ä¿æŒç¾æœ‰ prompt çµæ§‹ä¸è®Šï¼ˆé‡ç”¨æ¶æ§‹ï¼‰
- âœ… ä½¿ç”¨è¡¨æ ¼æ ¼å¼ç²¾ç°¡èªå¥ï¼ˆæ§åˆ¶ tokenï¼‰
- âœ… æŠ½å‡ºé—œéµå­—å°ç…§è¡¨ç‚ºç¨ç«‹å€å¡Šï¼ˆåšæˆå‡½å¼æ¦‚å¿µï¼‰

### Step 2: æ›´æ–° GPT è™•ç†å™¨ï¼ˆapp/gpt_processor.pyï¼‰

**ç›®æ¨™**ï¼šç¢ºä¿ GPT å›æ‡‰çš„ä»£å¢Šæ¬„ä½æ­£ç¢ºå¡«å……åˆ° `BookkeepingEntry`ã€‚

#### 2.1 æª¢æŸ¥ BookkeepingEntry å®šç¾©

ç¢ºèª `@dataclass BookkeepingEntry` åŒ…å«ä»¥ä¸‹æ¬„ä½ï¼ˆæ‡‰è©²å·²å­˜åœ¨ï¼‰ï¼š

```python
ä»£å¢Šç‹€æ…‹: Optional[str] = "ç„¡"
æ”¶æ¬¾æ”¯ä»˜å°è±¡: Optional[str] = ""
```

#### 2.2 æ›´æ–° process_multi_expense å‡½å¼

åœ¨ `process_multi_expense()` å‡½å¼ä¸­ï¼ŒGPT å›æ‡‰ JSON è§£æå€å¡Šï¼Œç¢ºä¿è®€å–ä»£å¢Šæ¬„ä½ï¼š

```python
# å‡è¨­ GPT å›æ‡‰æ ¼å¼ç‚ºï¼š
# {
#   "intent": "multi_bookkeeping",
#   "items": [{
#     "å“é …": "...",
#     "ä»£å¢Šç‹€æ…‹": "ä»£å¢Š",      // â­ è®€å–æ­¤æ¬„ä½
#     "æ”¶æ¬¾æ”¯ä»˜å°è±¡": "å¦¹"     // â­ è®€å–æ­¤æ¬„ä½
#   }]
# }

for item in gpt_response["items"]:
    entry = BookkeepingEntry(
        ...
        ä»£å¢Šç‹€æ…‹=item.get("ä»£å¢Šç‹€æ…‹", "ç„¡"),         # â­ æ–°å¢ï¼Œé è¨­ã€Œç„¡ã€
        æ”¶æ¬¾æ”¯ä»˜å°è±¡=item.get("æ”¶æ¬¾æ”¯ä»˜å°è±¡", ""),   # â­ æ–°å¢ï¼Œé è¨­ç©ºå­—ä¸²
        ...
    )
```

**æ³¨æ„**ï¼š
- ä½¿ç”¨ `.get()` æä¾›é è¨­å€¼ï¼Œç¢ºä¿å‘ä¸‹ç›¸å®¹
- GPT å¯èƒ½çœç•¥ä»£å¢Šæ¬„ä½ï¼ˆä¸€èˆ¬æ”¯å‡ºæ™‚ï¼‰ï¼Œé è¨­å€¼ç¢ºä¿ä¸å ±éŒ¯

### Step 3: æ›´æ–° LINE ç¢ºèªè¨Šæ¯ï¼ˆapp/line_handler.pyï¼‰

**ç›®æ¨™**ï¼šåœ¨ç¢ºèªè¨Šæ¯ä¸­é¡¯ç¤ºä»£å¢Šç‹€æ…‹å’Œå°è±¡è³‡è¨Šã€‚

#### 3.1 ä¿®æ”¹ format_confirmation_message å‡½å¼

åœ¨ã€Œå¿…è¦æ€§ã€ä¹‹å¾Œï¼Œã€Œæ—¥æœŸã€ä¹‹å‰ï¼Œæ’å…¥ä»£å¢Šè³‡è¨Šï¼š

```python
def format_confirmation_message(entry: BookkeepingEntry) -> str:
    twd_amount = entry.åŸå¹£é‡‘é¡ * entry.åŒ¯ç‡

    message = f"""âœ… è¨˜å¸³æˆåŠŸï¼

ğŸ“‹ {entry.å“é …}
ğŸ’µ æ–°å°å¹£ï¼š{twd_amount:.0f} å…ƒ
ğŸ’³ ä»˜æ¬¾æ–¹å¼ï¼š{entry.ä»˜æ¬¾æ–¹å¼}
ğŸ“‚ åˆ†é¡ï¼š{entry.åˆ†é¡}
â­ å¿…è¦æ€§ï¼š{entry.å¿…è¦æ€§}"""

    # â­ æ–°å¢ä»£å¢Šè³‡è¨Šé¡¯ç¤ºï¼ˆæ¢ä»¶é¡¯ç¤ºï¼‰
    if entry.ä»£å¢Šç‹€æ…‹ == "ä»£å¢Š":
        message += f"\nğŸ’¸ ä»£å¢Šçµ¦ï¼š{entry.æ”¶æ¬¾æ”¯ä»˜å°è±¡}"
    elif entry.ä»£å¢Šç‹€æ…‹ == "éœ€æ”¯ä»˜":
        message += f"\nğŸ’° éœ€æ”¯ä»˜çµ¦ï¼š{entry.æ”¶æ¬¾æ”¯ä»˜å°è±¡}"
    elif entry.ä»£å¢Šç‹€æ…‹ == "ä¸ç´¢å–":
        message += f"\nğŸ ä¸ç´¢å–ï¼ˆä»£å¢Šçµ¦ï¼š{entry.æ”¶æ¬¾æ”¯ä»˜å°è±¡}ï¼‰"

    message += f"""
ğŸ“… æ—¥æœŸï¼š{entry.æ—¥æœŸ}
ğŸ”– äº¤æ˜“IDï¼š{entry.äº¤æ˜“ID}"""

    if entry.æ˜ç´°èªªæ˜:
        message += f"\nğŸ“ æ˜ç´°èªªæ˜ï¼š{entry.æ˜ç´°èªªæ˜}"

    return message
```

#### 3.2 ä¿®æ”¹ format_multi_confirmation_message å‡½å¼

åœ¨å¤šé …ç›®æ ¼å¼ä¸­ï¼Œæ¯å€‹é …ç›®ä¹Ÿæ–°å¢ä»£å¢Šè³‡è¨Šï¼š

```python
def format_multi_confirmation_message(result: MultiExpenseResult, success_count: int, failure_count: int) -> str:
    ...
    for idx, entry in enumerate(entries, start=1):
        twd_amount = entry.åŸå¹£é‡‘é¡ * entry.åŒ¯ç‡

        message += f"\nğŸ“‹ #{idx} {entry.å“é …}"
        message += f"\nğŸ’° {twd_amount:.0f} å…ƒ"
        message += f"\nğŸ“‚ {entry.åˆ†é¡}"
        message += f"\nâ­ {entry.å¿…è¦æ€§}"

        if entry.æ˜ç´°èªªæ˜:
            message += f"\nğŸ“ {entry.æ˜ç´°èªªæ˜}"

        # â­ æ–°å¢ä»£å¢Šè³‡è¨Šé¡¯ç¤º
        if entry.ä»£å¢Šç‹€æ…‹ == "ä»£å¢Š":
            message += f"\nğŸ’¸ ä»£å¢Šçµ¦ï¼š{entry.æ”¶æ¬¾æ”¯ä»˜å°è±¡}"
        elif entry.ä»£å¢Šç‹€æ…‹ == "éœ€æ”¯ä»˜":
            message += f"\nğŸ’° éœ€æ”¯ä»˜çµ¦ï¼š{entry.æ”¶æ¬¾æ”¯ä»˜å°è±¡}"
        elif entry.ä»£å¢Šç‹€æ…‹ == "ä¸ç´¢å–":
            message += f"\nğŸ ä¸ç´¢å–ï¼ˆä»£å¢Šçµ¦ï¼š{entry.æ”¶æ¬¾æ”¯ä»˜å°è±¡}ï¼‰"

        if idx < total_items:
            message += "\n"
    ...
```

### Step 4: é©—è­‰ Webhook ç™¼é€ï¼ˆapp/webhook_sender.pyï¼‰

**ç›®æ¨™**ï¼šç¢ºèª webhook payload åŒ…å«ä»£å¢Šæ¬„ä½ã€‚

#### 4.1 æª¢æŸ¥ send_to_webhook å‡½å¼

ç¢ºèª payload åŒ…å«ä»£å¢Šæ¬„ä½ï¼ˆæ‡‰è©²å·²å­˜åœ¨ï¼‰ï¼š

```python
payload = {
    "operation": "CREATE",
    ...
    "ä»£å¢Šç‹€æ…‹": entry.ä»£å¢Šç‹€æ…‹,          # âœ… æ‡‰å·²å­˜åœ¨
    "æ”¶æ¬¾æ”¯ä»˜å°è±¡": entry.æ”¶æ¬¾æ”¯ä»˜å°è±¡,  # âœ… æ‡‰å·²å­˜åœ¨
    ...
}
```

**å¦‚æœä¸å­˜åœ¨**ï¼Œè«‹æ–°å¢é€™å…©è¡Œã€‚

### Step 5: æ¸¬è©¦

#### 5.1 æœ¬åœ°æ¸¬è©¦ï¼ˆtest_local.pyï¼‰

ä½¿ç”¨ `test_local.py` æ¸¬è©¦åŸºæœ¬æ¡ˆä¾‹ï¼š

```bash
python test_local.py
```

**è¼¸å…¥æ¸¬è©¦è¨Šæ¯**ï¼š
1. ã€Œä»£å¦¹è³¼è²·Pizzaå…Œæ›åˆ¸979å…ƒç¾é‡‘ã€
2. ã€Œå¼Ÿä»£è¨‚æ—¥æœ¬ç™½é¦¬æˆ¿é–“10000å…ƒã€
3. ã€Œå¹«åª½åª½è²·è—¥500å…ƒç¾é‡‘ï¼Œä¸ç”¨é‚„ã€
4. ã€Œæ—©é¤80å…ƒï¼Œåˆé¤150å…ƒå¹«åŒäº‹ä»£å¢Šï¼Œç¾é‡‘ã€

**é©—è­‰**ï¼š
- âœ… GPT æ­£ç¢ºè­˜åˆ¥ä»£å¢Šç‹€æ…‹
- âœ… æå–æ”¶æ¬¾ï¼æ”¯ä»˜å°è±¡
- âœ… ç¢ºèªè¨Šæ¯é¡¯ç¤ºä»£å¢Šè³‡è¨Š
- âœ… JSON åŒ…å«ä»£å¢Šæ¬„ä½

#### 5.2 æ•´åˆæ¸¬è©¦ï¼ˆpytestï¼‰

åŸ·è¡Œå®Œæ•´æ¸¬è©¦å¥—ä»¶ï¼š

```bash
pytest tests/test_gpt_processor.py -v
pytest tests/test_multi_expense.py -v
```

**æ–°å¢æ¸¬è©¦æ¡ˆä¾‹**ï¼ˆåƒè€ƒ spec.md é©—æ”¶å ´æ™¯ï¼‰ï¼š
- ä»£å¢ŠåŸºæœ¬æ¡ˆä¾‹ Ã— 5
- éœ€æ”¯ä»˜åŸºæœ¬æ¡ˆä¾‹ Ã— 5
- ä¸ç´¢å–æ¡ˆä¾‹ Ã— 3
- å¤šé …ç›®æ··åˆ Ã— 2
- é‚Šç·£æ¡ˆä¾‹ Ã— 5

#### 5.3 ç«¯åˆ°ç«¯æ¸¬è©¦ï¼ˆçœŸå¯¦ LINEï¼‰

ä½¿ç”¨çœŸå¯¦ LINE bot æ¸¬è©¦ï¼š
1. ç™¼é€æ¸¬è©¦è¨Šæ¯åˆ° LINE bot
2. é©—è­‰å›è¦†è¨Šæ¯æ ¼å¼æ­£ç¢º
3. æª¢æŸ¥ Make.com webhook æ¥æ”¶è³‡æ–™ï¼ˆéœ€ç™»å…¥ Make.com æŸ¥çœ‹ï¼‰

## å¯¦ä½œæª¢æŸ¥æ¸…å–®

### å¿…é ˆå®Œæˆï¼ˆP1ï¼‰

- [ ] `app/prompts.py`ï¼šæ–°å¢ `ADVANCE_PAYMENT_RULES` å¸¸æ•¸
- [ ] `app/prompts.py`ï¼šæ•´åˆ `ADVANCE_PAYMENT_RULES` åˆ° `MULTI_EXPENSE_PROMPT`
- [ ] `app/prompts.py`ï¼šæ›´æ–°è¼¸å‡ºæ ¼å¼ç¯„ä¾‹ï¼ˆåŒ…å«ä»£å¢Šæ¬„ä½ï¼‰
- [ ] `app/gpt_processor.py`ï¼šç¢ºèª `process_multi_expense` è®€å–ä»£å¢Šæ¬„ä½
- [ ] `app/line_handler.py`ï¼šä¿®æ”¹ `format_confirmation_message` é¡¯ç¤ºä»£å¢Šè³‡è¨Š
- [ ] `app/line_handler.py`ï¼šä¿®æ”¹ `format_multi_confirmation_message` é¡¯ç¤ºä»£å¢Šè³‡è¨Š
- [ ] `app/webhook_sender.py`ï¼šç¢ºèª payload åŒ…å«ä»£å¢Šæ¬„ä½
- [ ] æ¸¬è©¦ï¼šä»£å¢ŠåŸºæœ¬æ¡ˆä¾‹ï¼ˆ5 å€‹ï¼‰
- [ ] æ¸¬è©¦ï¼šéœ€æ”¯ä»˜åŸºæœ¬æ¡ˆä¾‹ï¼ˆ5 å€‹ï¼‰
- [ ] æ¸¬è©¦ï¼šå¤šé …ç›®æ··åˆï¼ˆ2 å€‹ï¼‰

### å»ºè­°å®Œæˆï¼ˆP2ï¼‰

- [ ] æ¸¬è©¦ï¼šä¸ç´¢å–æ¡ˆä¾‹ï¼ˆ3 å€‹ï¼‰
- [ ] æ¸¬è©¦ï¼šé‚Šç·£æ¡ˆä¾‹ï¼ˆ5 å€‹ï¼‰
- [ ] ç«¯åˆ°ç«¯æ¸¬è©¦ï¼ˆçœŸå¯¦ LINEï¼‰
- [ ] æ›´æ–° `test_local.py` æ”¯æ´ä»£å¢Šè³‡è¨Šé¡¯ç¤º

### æ˜ç¢ºæ’é™¤ï¼ˆv1.7 ä¸åšï¼‰

- âŒ ä»£å¢Šç‹€æ…‹æ›´æ–°åŠŸèƒ½ï¼ˆv1.8 è¦åŠƒï¼‰
- âŒ æ”¶æ“šåœ–ç‰‡è­˜åˆ¥ä»£å¢Šï¼ˆv1.7 ä¸æ”¯æ´ï¼‰
- âŒ ä»£å¢Šæ¬¾é …æé†’åŠŸèƒ½ï¼ˆv2 è¦åŠƒï¼‰

## å¸¸è¦‹å•é¡Œ

### Q1: GPT ç„¡æ³•è­˜åˆ¥ä»£å¢Šç‹€æ…‹ï¼Ÿ

**æ’æŸ¥æ­¥é©Ÿ**ï¼š
1. ç¢ºèª `ADVANCE_PAYMENT_RULES` å·²æ­£ç¢ºæ’å…¥ prompt
2. æª¢æŸ¥ GPT å›æ‡‰ JSON æ ¼å¼ï¼ˆä½¿ç”¨ `logger.info` è¼¸å‡ºï¼‰
3. é©—è­‰é—œéµå­—æ˜¯å¦åœ¨å°ç…§è¡¨ä¸­
4. æ¸¬è©¦æ›´æ˜ç¢ºçš„è¨Šæ¯ï¼ˆå¦‚ã€Œä»£å¦¹è²·ã€è€Œéã€Œå¹«å¿™è²·ã€ï¼‰

### Q2: ç¢ºèªè¨Šæ¯æœªé¡¯ç¤ºä»£å¢Šè³‡è¨Šï¼Ÿ

**æ’æŸ¥æ­¥é©Ÿ**ï¼š
1. ç¢ºèª `entry.ä»£å¢Šç‹€æ…‹` ä¸ç‚ºã€Œç„¡ã€
2. æª¢æŸ¥ `format_confirmation_message` æ¢ä»¶åˆ¤æ–·é‚è¼¯
3. é©—è­‰åœ–ç¤ºé¡¯ç¤ºæ­£ç¢ºï¼ˆğŸ’¸ã€ğŸ’°ã€ğŸï¼‰

### Q3: Webhook ç¼ºå°‘ä»£å¢Šæ¬„ä½ï¼Ÿ

**æ’æŸ¥æ­¥é©Ÿ**ï¼š
1. æª¢æŸ¥ `payload` å­—å…¸æ˜¯å¦åŒ…å« `"ä»£å¢Šç‹€æ…‹"` å’Œ `"æ”¶æ¬¾æ”¯ä»˜å°è±¡"`
2. ä½¿ç”¨ `logger.info(payload)` è¼¸å‡º payload æª¢æŸ¥
3. ç¢ºèª Make.com ç«¯æ¥æ”¶é‚è¼¯å·²æ›´æ–°ï¼ˆéœ€è¯ç¹« Make.com ç®¡ç†å“¡ï¼‰

## é ä¼°å·¥æ™‚

| æ­¥é©Ÿ | é ä¼°æ™‚é–“ |
|-----|---------|
| Step 1: å¢å¼· Prompt | 30 åˆ†é˜ |
| Step 2: æ›´æ–°è™•ç†å™¨ | 15 åˆ†é˜ |
| Step 3: æ›´æ–°è¨Šæ¯æ ¼å¼ | 30 åˆ†é˜ |
| Step 4: é©—è­‰ Webhook | 10 åˆ†é˜ |
| Step 5: æ¸¬è©¦ï¼ˆæœ¬åœ° + æ•´åˆï¼‰ | 60 åˆ†é˜ |
| Step 5: ç«¯åˆ°ç«¯æ¸¬è©¦ | 30 åˆ†é˜ |
| **ç¸½è¨ˆ** | **2.5 - 3 å°æ™‚** |

## ä¸‹ä¸€æ­¥

å®Œæˆ quickstart å¾Œï¼ŒåŸ·è¡Œ `/speckit.tasks` ç”Ÿæˆ tasks.mdï¼Œæ‹†è§£ç‚ºå¯åŸ·è¡Œä»»å‹™æ¸…å–®ã€‚

## åƒè€ƒæ–‡ä»¶

- [spec.md](./spec.md) â€” åŠŸèƒ½è¦æ ¼æ›¸
- [research.md](./research.md) â€” æŠ€è¡“ç ”ç©¶
- [data-model.md](./data-model.md) â€” è³‡æ–™æ¨¡å‹
- [contracts/advance-payment-webhook.json](./contracts/advance-payment-webhook.json) â€” Webhook Schema
