# æ¸¬è©¦è…³æœ¬æ•´åˆå¯¦ä½œè¨ˆç•«ï¼ˆåŠŸèƒ½åˆ†é¡ï¼‰

## ğŸ¯ ç›®æ¨™
- å°‡ç¾æœ‰ `run_v*_tests.sh`ï¼ˆç‰ˆæœ¬åˆ†æµï¼‰æ•´åˆæˆå–®ä¸€å…¥å£ï¼Œæ”¹ä»¥åŠŸèƒ½åˆ†é¡ suite åŸ·è¡Œã€‚
- æä¾›ä¸€è‡´çš„ CLI ä»‹é¢èˆ‡è‡ªå‹•/äººå·¥æ¨¡å¼ï¼Œä½œç‚ºå¾ŒçºŒ Prompt/Schema é‡æ§‹çš„å›æ­¸é©—è­‰åŸºç¤ã€‚
- è§£æç­–ç•¥çµ±ä¸€ï¼šä»¥ `jq` è§£æ JSON ç‚ºå¿…å‚™ä¾è³´ï¼›ç¼ºå°‘ `jq` æ™‚ç›´æ¥å ±éŒ¯ä¸¦æç¤ºå®‰è£ã€‚

## âœ… ç¯„åœ
- æ–°å¢ï¼š`run_tests.sh`ï¼ˆçµ±ä¸€å…¥å£ï¼‰
- æ–°å¢ï¼šsuite æ¡ˆä¾‹è³‡æ–™æª”ï¼ˆåŠŸèƒ½åˆ†é¡ï¼‰
- èª¿æ•´ï¼š`run_v1_tests.sh` / `run_v15_tests.sh` / `run_v17_tests.sh` è½‰ç‚º shimï¼ˆè½‰å‘¼å« `run_tests.sh`ï¼‰
- ä¸æ”¹ï¼šæ—¢æœ‰æ¡ˆä¾‹å…§å®¹ï¼ˆè¨Šæ¯èˆ‡æœŸæœ›å€¼ä¸è®Šï¼Œå…ˆå»ºç«‹ baselineï¼›å¾ŒçºŒå†ä¾éœ€æ±‚èª¿æ•´æ¡ˆä¾‹åˆ†çµ„ï¼‰

## ğŸ§© Suite åˆ†é¡
- `expense`ï¼šå–®é …/åŸºæœ¬æ¬„ä½ï¼ˆå“é …ã€é‡‘é¡ã€ä»˜æ¬¾æ–¹å¼ã€åˆ†é¡ã€æ„åœ–/å°è©±ï¼‰
- `multi_expense`ï¼šå¤šé …ç›®ï¼ˆé …ç›®æ•¸ã€å…±ç”¨ä»˜æ¬¾æ–¹å¼ã€éŒ¯èª¤è™•ç†ï¼‰
- `advance_payment`ï¼šä»£å¢Šï¼ˆä»£å¢Šç‹€æ…‹ã€å°è±¡ã€ä»˜æ¬¾æ–¹å¼ NA è¦å‰‡ã€æ—¥æœŸã€å¤šé …æ•´åˆï¼‰

## ğŸ–¥ï¸ CLI ä»‹é¢ï¼ˆrun_tests.shï¼‰
- `./run_tests.sh --suite <expense|multi_expense|advance_payment>`
- å¯é¸åƒæ•¸ï¼š
  - `--auto`ï¼šè‡ªå‹•åˆ¤æ–·ï¼ˆé è¨­é—œé–‰ï¼‰
  - `--manual`ï¼šäººå·¥åˆ¤æ–·ï¼ˆé è¨­ï¼‰
  - `--only <pattern>`ï¼šåªåŸ·è¡Œåç¨±æˆ–è¨Šæ¯ç¬¦åˆçš„æ¸¬è©¦ï¼ˆregexï¼‰
  - `--help`ï¼šé¡¯ç¤ºèªªæ˜

## ğŸ”§ ä¾è³´èˆ‡å¤±æ•—ç­–ç•¥
- å¿…å‚™ï¼š`jq`
  - å•Ÿå‹•æ™‚æª¢æŸ¥ï¼šè‹¥ `command -v jq` ä¸å­˜åœ¨ â†’ ç›´æ¥é€€å‡ºï¼ˆexit 2ï¼‰ï¼Œæç¤ºï¼š
    - macOSï¼š`brew install jq`
    - Ubuntu/Debianï¼š`sudo apt-get install -y jq`
- ä¸å†æä¾› grep fallbackï¼ˆé¿å…è§£æä¸ä¸€è‡´/èª¤åˆ¤ï¼‰ã€‚

## ğŸ§± è³‡æ–™çµæ§‹èˆ‡æª”æ¡ˆä½ˆå±€ï¼ˆå»ºè­°ï¼‰
- `tests/suites/expense.sh`
- `tests/suites/multi_expense.sh`
- `tests/suites/advance_payment.sh`

æ¯å€‹ suite æª”æ¡ˆåƒ…è² è²¬ã€Œåˆ—å‡ºæ¡ˆä¾‹ã€ï¼Œä¾‹å¦‚ï¼ˆæ¦‚å¿µï¼‰ï¼š
- `TEST_CASES+=("TC-EXP-001|Category|Description|Message|ExpectedIntent|...")`

ç”± `run_tests.sh` è§£æä¸¦åŸ·è¡Œï¼Œä¸åœ¨ suite æª”æ¡ˆä¸­æ”¾æ¯”è¼ƒ/è§£æé‚è¼¯ã€‚

## ğŸ§ª æ¬„ä½æŠ½è±¡èˆ‡æ¯”å°è¦å‰‡ï¼ˆçµ±ä¸€ï¼‰
- å…±åŒæŠ½è±¡æ¬„ä½ï¼š
  - `intent`ï¼šè¨˜å¸³/å°è©±/éŒ¯èª¤ï¼ˆç”± emoji è¼¸å‡ºæŠ½å–ï¼Œé¿å…ä¾è³´ JSON æ¬„ä½å½¢ç‹€ï¼‰
  - `item_count`ï¼šé …ç›®æ•¸ï¼ˆå¤šé …ç›®ç‚º entries/items é•·åº¦ï¼‰
  - `payment`ï¼šä»˜æ¬¾æ–¹å¼ï¼ˆå…±ç”¨æˆ–å–®ç­†ï¼‰
  - `item`ï¼šå“é …ï¼ˆå–®ç­†æˆ– entries[0]ï¼‰
  - `amount`ï¼šåŸå¹£é‡‘é¡ï¼ˆæ•¸å­—ï¼‰
  - `category`ï¼šåˆ†é¡ï¼ˆå…è¨±éƒ¨åˆ†åŒ¹é…æˆ–è¦å‰‡åŒ–æ¯”è¼ƒï¼‰
  - `advance_status`ï¼šä»£å¢Šç‹€æ…‹
  - `recipient`ï¼šæ”¶æ¬¾æ”¯ä»˜å°è±¡
  - `error_message`ï¼šéŒ¯èª¤è¨Šæ¯ï¼ˆåŒ…å«æ¯”å°ï¼‰
- ä¸æ¯”å°ï¼š
  - `transaction_id`ï¼ˆéæ±ºå®šæ€§ï¼‰

## ğŸ§© èˆŠè…³æœ¬ shim ç­–ç•¥
- ä¿ç•™åŸæª”åé¿å…ä½¿ç”¨è€…ç¿’æ…£æ–·è£‚ï¼Œä½†å…§å®¹æ”¹ç‚ºè½‰å‘¼å«ï¼š
  - `run_v1_tests.sh` â†’ `./run_tests.sh --suite expense`ï¼ˆè½‰è­¯ `--auto`ï¼‰
  - `run_v15_tests.sh` â†’ `./run_tests.sh --suite multi_expense`
  - `run_v17_tests.sh` â†’ `./run_tests.sh --suite advance_payment`ï¼ˆè½‰è­¯ `--only`ï¼‰
- shim æœ¬èº«ä¸å†å…§å»ºæ¡ˆä¾‹èˆ‡è§£æé‚è¼¯ã€‚

## âœ… é©—è­‰æ–¹å¼ï¼ˆbaselineï¼‰
1) æ–°å…¥å£å…ˆåªè·‘å°‘é‡æ¡ˆä¾‹ï¼ˆæ¯å€‹ suite 1~2 æ¢ï¼‰é©—è­‰ CLI/è§£æ/çµ±è¨ˆã€‚
2) æ¬ç§»å…¨éƒ¨æ¡ˆä¾‹å¾Œï¼Œåˆ†åˆ¥åŸ·è¡Œï¼š
   - `./run_tests.sh --suite expense --auto`
   - `./run_tests.sh --suite multi_expense --auto`
   - `./run_tests.sh --suite advance_payment --auto --only <pattern>`
3) èˆ‡èˆŠè…³æœ¬çµæœå°ç…§ï¼ˆä»¥æŠ½è±¡æ¬„ä½ç‚ºæº–ï¼‰ï¼Œç¢ºä¿ baseline ä¸€è‡´ã€‚

## âš ï¸ é¢¨éšªèˆ‡ç·©è§£
- `jq` ç¼ºå¤±å°è‡´ç„¡æ³•è·‘ï¼šç”¨å•Ÿå‹•æª¢æŸ¥èˆ‡æ˜ç¢ºå®‰è£æŒ‡å¼•é™ä½æ‘©æ“¦ã€‚
- GPT å›æ‡‰éæ±ºå®šæ€§ï¼šbaseline å…ˆåªé–å®šå¯æ¯”å°æ¬„ä½ï¼Œé¿å…æ¯”å°äº¤æ˜“IDç­‰éç©©å®šæ¬„ä½ã€‚
- æ—¢æœ‰è¼¸å‡ºæ ¼å¼å·®ç•°ï¼šæŠ½è±¡å±¤é›†ä¸­è™•ç†ï¼ˆentries vs å–®ç­†ã€å…±ç”¨ä»˜æ¬¾ vs å–®ç­†ä»˜æ¬¾ï¼‰ã€‚
