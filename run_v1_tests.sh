#!/bin/bash
# v1 MVP 測試腳本 - 逐個測試並檢視結果

echo "======================================================================"
echo "🧪 v1 MVP 測試腳本"
echo "======================================================================"
echo ""
echo "使用方式："
echo "  - 每個測試案例會顯示測試訊息和結果"
echo "  - 按 Enter 繼續下一個測試"
echo "  - 按 Ctrl+C 中斷測試"
echo ""
read -p "按 Enter 開始測試..."

# 測試函數
run_test() {
    local category="$1"
    local description="$2"
    local message="$3"

    echo ""
    echo "======================================================================"
    echo "[$category] $description"
    echo "======================================================================"
    echo ""

    python test_local.py --v1 "$message"

    echo ""
    read -p "按 Enter 繼續下一個測試..."
}

# ============================================================
# 基本記帳功能
# ============================================================

run_test "基本功能" "TC-V1-001: 標準記帳格式" "午餐120元現金"

run_test "基本功能" "TC-V1-002: 順序不固定" "200 點心 狗卡"

run_test "基本功能" "TC-V1-003: 含小數金額" "咖啡45.5元 Line轉帳"

# ============================================================
# 日期與時間處理
# ============================================================

run_test "日期處理" "TC-V1-010: 語義化日期 - 今天" "今天午餐120元現金"

run_test "日期處理" "TC-V1-011: 語義化日期 - 昨天" "昨天晚餐200元狗卡"

run_test "日期處理" "TC-V1-012: 數字日期格式 (11/12)" "11/12 午餐120元現金"

run_test "日期處理" "TC-V1-013: 完整日期格式" "2025-11-10 咖啡50元現金"

run_test "日期處理" "TC-V1-014: 無日期（預設今天）" "午餐120元現金"

# ============================================================
# 付款方式識別
# ============================================================

run_test "付款方式" "TC-V1-020: 現金" "午餐120元現金"

run_test "付款方式" "TC-V1-021: Line 轉帳（暱稱）" "午餐120元Line"

run_test "付款方式" "TC-V1-022: 台新狗卡（暱稱）" "午餐120元狗卡"

run_test "付款方式" "TC-V1-023: FlyGo 信用卡（暱稱）" "午餐120元灰狗"

run_test "付款方式" "TC-V1-024: 合庫轉帳" "午餐120元合庫"

run_test "付款方式" "TC-V1-025: 台新 Richart" "午餐120元Richart"

# ============================================================
# 品項與分類
# ============================================================

run_test "品項分類" "TC-V1-030: 早餐分類" "早餐50元現金"

run_test "品項分類" "TC-V1-030: 午餐分類" "午餐120元現金"

run_test "品項分類" "TC-V1-030: 晚餐分類" "晚餐200元現金"

run_test "品項分類" "TC-V1-031: 點心分類（預設家庭）" "花磚甜點200元現金"

run_test "品項分類" "TC-V1-032: 含商家名稱（無介詞）" "義美蛋糕120元現金"

run_test "品項分類" "TC-V1-033: 含商家名稱（有介詞）" "在開飯吃午餐120元現金"

run_test "品項分類" "TC-V1-034: 含用途說明" "饅頭做早餐使用200元現金"

# ============================================================
# 自然語句處理
# ============================================================

run_test "自然語句" "TC-V1-040: 自然語句 - 買了" "買了咖啡50元，Line轉帳"

run_test "自然語句" "TC-V1-041: 自然語句 - 花了" "晚餐吃麵，花了80，用狗卡"

run_test "自然語句" "TC-V1-042: 自然語句 - 複雜描述" "今天買了星巴克咖啡，花了150元，用Line轉帳付款"

# ============================================================
# 對話意圖識別
# ============================================================

run_test "對話意圖" "TC-V1-050: 打招呼" "你好"

run_test "對話意圖" "TC-V1-051: 詢問功能" "可以幫我做什麼？"

run_test "對話意圖" "TC-V1-052: 感謝" "謝謝"

# ============================================================
# 錯誤處理
# ============================================================

run_test "錯誤處理" "TC-V1-060: 缺少金額" "午餐現金"

run_test "錯誤處理" "TC-V1-061: 缺少付款方式" "午餐120元"

run_test "錯誤處理" "TC-V1-062: 缺少品項" "120元現金"

# ============================================================
# 完成
# ============================================================

echo ""
echo "======================================================================"
echo "✅ v1 MVP 測試完成！"
echo "======================================================================"
echo ""
echo "測試統計："
echo "  - 基本功能：3 個測試"
echo "  - 日期處理：5 個測試"
echo "  - 付款方式：6 個測試"
echo "  - 品項分類：7 個測試"
echo "  - 自然語句：3 個測試"
echo "  - 對話意圖：3 個測試"
echo "  - 錯誤處理：3 個測試"
echo "  - 總計：30 個測試"
echo ""
