# Release Notes - v1.3.0

**ç™¼å¸ƒæ—¥æœŸ**: 2025-11-16
**ç‰ˆæœ¬**: v1.3.0

## ğŸ¯ é‡é»åŠŸèƒ½

### âœ¨ ä¿®æ”¹ä¸Šä¸€ç­†è¨˜å¸³

æ–°å¢ã€Œä¿®æ”¹ä¸Šä¸€ç­†ã€åŠŸèƒ½ï¼Œè®“ä½ å¯ä»¥å¿«é€Ÿä¿®æ­£å‰›æ‰çš„è¨˜å¸³å…§å®¹ï¼Œä¸éœ€è¦é‡æ–°è¼¸å…¥æ‰€æœ‰è³‡è¨Šã€‚

**ä½¿ç”¨æ–¹å¼**ï¼š
```
ä½ ï¼šã€Œå’–å•¡50å…ƒï¼Œç¾é‡‘ã€
Botï¼šâœ… è¨˜å¸³æˆåŠŸï¼...

ä½ ï¼šã€Œä¸Šä¸€ç­†æ”¹æˆLine Payã€
Botï¼šâœ… å·²æ›´æ–°ä¸Šä¸€ç­†è¨˜å¸³
     â€¢ ä»˜æ¬¾æ–¹å¼ï¼šç¾é‡‘ â†’ Line Pay
```

**æ”¯æ´çš„é—œéµè©**ï¼š
- ã€Œä¸Šä¸€ç­†æ”¹æˆ...ã€
- ã€Œå‰›æ‰é‚£ç­†æ”¹æˆ...ã€
- ã€Œå‰›å‰›æ”¹æˆ...ã€
- ã€Œä¿®æ”¹ä»˜æ¬¾æ–¹å¼ç‚º...ã€

**æ”¯æ´æ›´æ–°çš„æ¬„ä½**ï¼š
- ä»˜æ¬¾æ–¹å¼ï¼ˆæœ€å¸¸ç”¨ï¼‰
- åˆ†é¡
- æ˜ç´°èªªæ˜
- å¿…è¦æ€§

**æŠ€è¡“ç´°ç¯€**ï¼š
- ä½¿ç”¨ Vercel Redis å„²å­˜æœ€å¾Œä¸€ç­†äº¤æ˜“
- è¨˜éŒ„ä¿ç•™ 10 åˆ†é˜ï¼ˆå¯é€é `LAST_TRANSACTION_TTL` ç’°å¢ƒè®Šæ•¸èª¿æ•´ï¼‰
- æ›´æ–°æˆåŠŸå¾Œè‡ªå‹•åˆªé™¤è¨˜éŒ„ï¼ˆé˜²æ­¢é‡è¤‡ä¿®æ”¹ï¼‰
- é€é Make.com Router çš„ UPDATE è·¯å¾‘æ›´æ–° Notion

---

## ğŸ¨ ä»‹é¢å„ªåŒ–

### çµ±ä¸€ç¢ºèªè¨Šæ¯æ ¼å¼

å–®é …ç›®å’Œå¤šé …ç›®è¨˜å¸³è¨Šæ¯æ ¼å¼çµ±ä¸€ï¼Œä½¿ç”¨ä¸€è‡´çš„ emoji åœ–ç¤ºã€‚

**å–®é …ç›®**ï¼š
```
âœ… è¨˜å¸³æˆåŠŸï¼

ğŸ“‹ å’–å•¡
ğŸ’° é‡‘é¡ï¼š50 å…ƒ TWD
ğŸ’³ ä»˜æ¬¾æ–¹å¼ï¼šç¾é‡‘
ğŸ“‚ åˆ†é¡ï¼šå®¶åº­ï¼é£²å“
â­ å¿…è¦æ€§ï¼šå¿…è¦æ—¥å¸¸æ”¯å‡º
ğŸ”– äº¤æ˜“IDï¼š20251116-110930
ğŸ“… æ—¥æœŸï¼š2025-11-16
```

**å¤šé …ç›®**ï¼š
```
âœ… è¨˜å¸³æˆåŠŸï¼å·²è¨˜éŒ„ 2 å€‹é …ç›®ï¼š

ğŸ“‹ #1 ç´…ç›®é°±
ğŸ’° 320 å…ƒ
ğŸ“‚ å®¶åº­ï¼é£Ÿæ
â­ å¿…è¦æ—¥å¸¸æ”¯å‡º

ğŸ“‹ #2 é¸šå“¥
ğŸ’° 400 å…ƒ
ğŸ“‚ å®¶åº­ï¼ç”¨å“ï¼é›œé …
â­ å¿…è¦æ—¥å¸¸æ”¯å‡º

ğŸ’³ ä»˜æ¬¾æ–¹å¼ï¼šç¾é‡‘
ğŸ”– äº¤æ˜“IDï¼š20251116-083546
ğŸ“… æ—¥æœŸï¼š2025-11-16
```

---

## ğŸ› Bug ä¿®å¾©

### GPT Prompt èª¤åˆ¤å•é¡Œ

**å•é¡Œ**ï¼šã€Œå’–å•¡50å…ƒï¼Œç¾é‡‘ã€è¢«èª¤åˆ¤ç‚º 2 å€‹é …ç›®ï¼Œå°è‡´ã€Œç¼ºå°‘å“é …åç¨±ã€éŒ¯èª¤ã€‚

**åŸå› **ï¼šGPT æŠŠã€Œç¾é‡‘ã€ç•¶ä½œç¨ç«‹é …ç›®è™•ç†ï¼Œè€Œéä»˜æ¬¾æ–¹å¼ã€‚

**ä¿®å¾©**ï¼š
- é‡æ–°å®šç¾©æ ¸å¿ƒè¦å‰‡ï¼šã€Œé …ç›® = å“é … + é‡‘é¡ã€
- æ˜ç¢ºæ¨™è¨»ï¼šç´”ä»˜æ¬¾æ–¹å¼é—œéµå­—ï¼ˆç‹—å¡ã€Lineã€ç¾é‡‘ç­‰ï¼‰ä¸æ˜¯é …ç›®
- æ–°å¢æ˜ç¢ºç¯„ä¾‹ï¼šã€Œå’–å•¡50å…ƒï¼Œç¾é‡‘ã€â†’ å–®é …ç›®

**å½±éŸ¿ç¯„åœ**ï¼š
- âœ… ã€Œå’–å•¡50å…ƒï¼Œç¾é‡‘ã€
- âœ… ã€Œåˆé¤120å…ƒï¼Œç‹—å¡ã€
- âœ… ã€Œç”¨Lineï¼Œé»å¿ƒ80å…ƒã€

### Vercel Redis ç’°å¢ƒè®Šæ•¸

**å•é¡Œ**ï¼šç¨‹å¼ç¢¼æœŸæœ› `KV_REST_API_URL`ï¼Œä½† Vercel å¯¦éš›æä¾› `REDIS_URL`ã€‚

**ä¿®å¾©**ï¼š
- ä¿®æ”¹ `app/config.py` ä½¿ç”¨ `REDIS_URL`
- ä¿®æ”¹ `app/kv_store.py` ç›´æ¥é€£ç·š `REDIS_URL`
- ç§»é™¤ä¸å¿…è¦çš„ token åƒæ•¸

---

## ğŸ”§ æŠ€è¡“æ”¹é€²

### Make.com Webhook è·¯ç”±

æ–°å¢ `operation` æ¬„ä½åˆ°æ‰€æœ‰ webhook payloadï¼Œæº–å‚™æ”¯æ´ UPDATE æ“ä½œã€‚

**CREATE Webhook**ï¼š
```json
{
  "operation": "CREATE",
  "æ—¥æœŸ": "2025-11-16",
  "å“é …": "å’–å•¡",
  "åŸå¹£é‡‘é¡": 50,
  "ä»˜æ¬¾æ–¹å¼": "ç¾é‡‘",
  ...
}
```

**UPDATE Webhook**ï¼š
```json
{
  "operation": "UPDATE",
  "user_id": "U1234567890abcdef",
  "transaction_id": "20251116-110930",
  "fields_to_update": {
    "ä»˜æ¬¾æ–¹å¼": "Line Pay"
  }
}
```

### ä¾è³´å¥—ä»¶æ›´æ–°

æ–°å¢ Redis æ”¯æ´ï¼š
```
redis>=5.0.0
```

---

## ğŸ“¦ å®Œæ•´è®Šæ›´æ¸…å–®

### æ–°å¢æª”æ¡ˆ
- `app/kv_store.py` - Vercel Redis æ•´åˆæ¨¡çµ„
- `RELEASE_NOTES_v1.3.0.md` - æœ¬æ–‡ä»¶

### ä¿®æ”¹æª”æ¡ˆ
- `app/config.py` - æ–°å¢ Redis é…ç½®
- `app/prompts.py` - ä¿®æ­£é …ç›®åˆ¤æ–·è¦å‰‡ï¼Œæ–°å¢ update_last_entry intent
- `app/gpt_processor.py` - è™•ç† update_last_entry intent
- `app/webhook_sender.py` - å„²å­˜äº¤æ˜“åˆ° Redisï¼Œæ–°å¢ UPDATE webhook
- `app/line_handler.py` - è™•ç†æ›´æ–°è«‹æ±‚ï¼Œçµ±ä¸€è¨Šæ¯æ ¼å¼
- `requirements.txt` - æ–°å¢ redis ä¾è³´

### Git Commits
- `a718557` - feat(webhook): add operation field for future UPDATE support
- `f6ee7ce` - feat(v1.5.0): implement update-last-entry feature with Vercel KV
- `c1df68c` - fix: resolve GPT prompt and Vercel Redis configuration issues
- `25be806` - style: unify confirmation message format with emojis

---

## ğŸš€ éƒ¨ç½²æŒ‡å—

### 1. Vercel Redis è¨­å®š

åœ¨ Vercel Dashboard ä¸­ï¼š
1. é€²å…¥å°ˆæ¡ˆ
2. é»æ“Š "Storage" â†’ "Create Database"
3. é¸æ“‡ "Redis"
4. é€£çµåˆ°å°ˆæ¡ˆï¼ˆè‡ªå‹•è¨­å®š `REDIS_URL` ç’°å¢ƒè®Šæ•¸ï¼‰

### 2. Make.com Router è¨­å®š

è¨­å®š Router åˆ†æµ CREATE å’Œ UPDATE æ“ä½œï¼š

```
Webhook â†’ Router â”¬â†’ [CREATE filter] â†’ Notion: Create Item
                 â””â†’ [UPDATE filter] â†’ Notion: Search â†’ Update Item
```

**CREATE Filter**: `operation` = `CREATE`
**UPDATE Filter**: `operation` = `UPDATE`

è©³ç´°è¨­å®šè«‹åƒè€ƒå°ˆæ¡ˆæ–‡ä»¶ã€‚

---

## âš ï¸ å·²çŸ¥é™åˆ¶

1. **ä¿®æ”¹æ™‚æ•ˆ**ï¼šåªèƒ½ä¿®æ”¹ 10 åˆ†é˜å…§çš„è¨˜å¸³ï¼ˆè¶…éæœƒé¡¯ç¤ºã€Œæ‰¾ä¸åˆ°è¨˜éŒ„ã€ï¼‰
2. **ä¸€æ¬¡æ€§ä¿®æ”¹**ï¼šæ¯ç­†è¨˜å¸³åªèƒ½ä¿®æ”¹ä¸€æ¬¡ï¼ˆæ›´æ–°å¾Œè¨˜éŒ„æœƒè¢«åˆªé™¤ï¼‰
3. **å–®ä¸€æ¬„ä½æ›´æ–°å„ªå…ˆ**ï¼šç›®å‰åƒ…æ”¯æ´æ›´æ–°ä»˜æ¬¾æ–¹å¼ï¼ˆæœ€å¸¸ç”¨å ´æ™¯ï¼‰

---

## ğŸ”œ ä¸‹ä¸€æ­¥è¨ˆç•«

v1.4.0 å°‡åŒ…å«ï¼š
- åœ–ç‰‡å£“ç¸®å„ªåŒ–ï¼ˆæ¸›å°‘ Vision API token æ¶ˆè€—ï¼‰
- Prompt æ¨¡çµ„åŒ–ï¼ˆæŠ½å–å…±ç”¨éƒ¨åˆ†ï¼‰
- æ”¶æ“šåœ–ç‰‡è¾¨è­˜æ”¹é€²

---

## ğŸ“ å‘å¾Œç›¸å®¹æ€§

âœ… v1.3.0 å®Œå…¨å‘å¾Œç›¸å®¹ v1.2.0ï¼š
- æ‰€æœ‰åŸæœ‰åŠŸèƒ½æ­£å¸¸é‹ä½œ
- å–®é …ç›®å’Œå¤šé …ç›®è¨˜å¸³ä¿æŒç›¸åŒé‚è¼¯
- åƒ…æ–°å¢ã€Œä¿®æ”¹ä¸Šä¸€ç­†ã€åŠŸèƒ½
- è¨Šæ¯æ ¼å¼è®Šæ›´ä¸å½±éŸ¿åŠŸèƒ½

å¦‚æœªè¨­å®š Vercel Redisï¼Œç³»çµ±ä»æ­£å¸¸é‹ä½œï¼Œåªæ˜¯ç„¡æ³•ä½¿ç”¨ã€Œä¿®æ”¹ä¸Šä¸€ç­†ã€åŠŸèƒ½ã€‚
