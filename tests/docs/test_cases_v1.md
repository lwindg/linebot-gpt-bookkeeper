# v1 MVP 測試案例

**Status**: legacy (human-readable reference)
**Source of truth**: `tests/functional/suites/expense.jsonl` + `tests/functional/suites/date.jsonl`
**Runner**: `./run_tests.sh --suite <expense|date>`

> This document is kept for manual reading. The canonical expectations live in the JSONL suites.
> If anything conflicts, follow the suite files.

---

## 測試分類

- [基本記帳功能](#基本記帳功能)
- [日期與時間處理](#日期與時間處理)
- [付款方式識別](#付款方式識別)
- [品項與分類](#品項與分類)
- [自然語句處理](#自然語句處理)
- [對話意圖識別](#對話意圖識別)
- [錯誤處理](#錯誤處理)

---

## 基本記帳功能

### TC-V1-001: 標準記帳格式
**輸入**：`午餐120元現金`
**預期結果**：
- ✅ 意圖：記帳
- ✅ 品項：午餐
- ✅ 金額：120 TWD
- ✅ 付款方式：現金
- ✅ 分類：家庭／餐飲／午餐
- ✅ 必要性：必要日常支出

### TC-V1-002: 順序不固定
**輸入**：`200 點心 狗卡`
**預期結果**：
- ✅ 意圖：記帳
- ✅ 品項：點心
- ✅ 金額：200 TWD
- ✅ 付款方式：台新狗卡

### TC-V1-003: 含小數金額
**輸入**：`咖啡45.5元 Line轉帳`
**預期結果**：
- ✅ 意圖：記帳
- ✅ 金額：45.5 TWD
- ✅ 付款方式：Line 轉帳

---

## 日期與時間處理

### TC-V1-010: 語義化日期 - 今天
**輸入**：`今天午餐120元現金`
**預期結果**：
- ✅ 日期：當天日期（YYYY-MM-DD）

### TC-V1-011: 語義化日期 - 昨天
**輸入**：`昨天晚餐200元狗卡`
**預期結果**：
- ✅ 日期：昨天日期（YYYY-MM-DD）

### TC-V1-012: 數字日期格式
**輸入**：`11/12 午餐120元現金`
**預期結果**：
- ✅ 日期：當年11-12（2025-11-12）

### TC-V1-013: 完整日期格式
**輸入**：`2025-11-10 咖啡50元現金`
**預期結果**：
- ✅ 日期：2025-11-10

### TC-V1-014: 無日期（預設今天）
**輸入**：`午餐120元現金`
**預期結果**：
- ✅ 日期：當天日期
- ✅ 交易ID：包含當前時間戳記

---

## 付款方式識別

### TC-V1-020: 現金
**輸入**：`午餐120元現金`
**預期結果**：
- ✅ 付款方式：現金

### TC-V1-021: Line 轉帳（暱稱）
**輸入**：`午餐120元Line`
**預期結果**：
- ✅ 付款方式：Line 轉帳

### TC-V1-022: 台新狗卡（暱稱）
**輸入**：`午餐120元狗卡`
**預期結果**：
- ✅ 付款方式：台新狗卡

### TC-V1-023: FlyGo 信用卡（暱稱）
**輸入**：`午餐120元灰狗`
**預期結果**：
- ✅ 付款方式：FlyGo 信用卡

### TC-V1-024: 合庫轉帳
**輸入**：`午餐120元合庫`
**預期結果**：
- ✅ 付款方式：合庫轉帳

### TC-V1-025: 台新 Richart
**輸入**：`午餐120元Richart`
**預期結果**：
- ✅ 付款方式：台新 Richart

---

## 品項與分類

### TC-V1-030: 三餐分類
**輸入**：`早餐50元現金`
**預期結果**：
- ✅ 品項：早餐
- ✅ 分類：家庭／餐飲／早餐

**輸入**：`午餐120元現金`
**預期結果**：
- ✅ 品項：午餐
- ✅ 分類：家庭／餐飲／午餐

**輸入**：`晚餐200元現金`
**預期結果**：
- ✅ 品項：晚餐
- ✅ 分類：家庭／餐飲／晚餐

### TC-V1-031: 點心分類（預設家庭）
**輸入**：`花磚甜點200元現金`
**預期結果**：
- ✅ 品項：花磚甜點
- ✅ 分類：家庭／點心

### TC-V1-032: 含商家名稱（無介詞 - 保持完整）
**輸入**：`義美蛋糕120元現金`
**預期結果**：
- ✅ 品項：義美蛋糕
- ✅ 明細說明：（空白）

### TC-V1-033: 含商家名稱（有介詞 - 分離）
**輸入**：`在開飯吃午餐120元現金`
**預期結果**：
- ✅ 品項：午餐
- ✅ 明細說明：開飯

### TC-V1-034: 含用途說明
**輸入**：`饅頭做早餐使用200元現金`
**預期結果**：
- ✅ 品項：饅頭
- ✅ 明細說明：做早餐使用

---

## 自然語句處理

### TC-V1-040: 自然語句 - 買了
**輸入**：`買了咖啡50元，Line轉帳`
**預期結果**：
- ✅ 意圖：記帳
- ✅ 品項：咖啡
- ✅ 金額：50 TWD
- ✅ 付款方式：Line 轉帳

### TC-V1-041: 自然語句 - 花了
**輸入**：`晚餐吃麵，花了80，用狗卡`
**預期結果**：
- ✅ 意圖：記帳
- ✅ 品項：晚餐 或 麵
- ✅ 金額：80 TWD
- ✅ 付款方式：台新狗卡

### TC-V1-042: 自然語句 - 複雜描述
**輸入**：`今天買了星巴克咖啡，花了150元，用Line轉帳付款`
**預期結果**：
- ✅ 意圖：記帳
- ✅ 品項：咖啡 或 星巴克咖啡
- ✅ 金額：150 TWD
- ✅ 付款方式：Line 轉帳

---

## 對話意圖識別

### TC-V1-050: 打招呼
**輸入**：`你好`
**預期結果**：
- ✅ 意圖：對話
- ✅ 回應：友善的問候

### TC-V1-051: 詢問功能
**輸入**：`可以幫我做什麼？`
**預期結果**：
- ✅ 意圖：對話
- ✅ 回應：說明功能

### TC-V1-052: 感謝
**輸入**：`謝謝`
**預期結果**：
- ✅ 意圖：對話
- ✅ 回應：禮貌回應

---

## 錯誤處理

### TC-V1-060: 缺少金額
**輸入**：`午餐現金`
**預期結果**：
- ✅ 意圖：對話
- ✅ 回應：提示「請提供品項名稱、金額和付款方式」

### TC-V1-061: 缺少付款方式
**輸入**：`午餐120元`
**預期結果**：
- ✅ 意圖：對話
- ✅ 回應：提示「請提供品項名稱、金額和付款方式」

### TC-V1-062: 缺少品項
**輸入**：`120元現金`
**預期結果**：
- ✅ 意圖：對話
- ✅ 回應：提示「請提供品項名稱、金額和付款方式」

### TC-V1-063: 空白訊息
**輸入**：``（空白）
**預期結果**：
- ⏭️ 跳過（互動模式）

---

## 測試執行方式

### 方法 1：List-only（offline, no OpenAI calls）
```bash
./run_tests.sh --suite expense --list
./run_tests.sh --suite date --list
./run_tests.sh --suite expense --list --only 'TC-V1-001|TC-V1-050'
```

### 方法 2：Manual（one-by-one）
```bash
./run_tests.sh --suite expense
./run_tests.sh --suite date
```

### 方法 3：Auto compare（requires OpenAI）
```bash
./run_tests.sh --suite expense --auto
./run_tests.sh --suite date --auto
```

### 方法 4：Ad-hoc local run
```bash
python test_local.py '午餐120元現金'
python test_local.py --raw '11/12 午餐120元現金'
```

---

## 測試檢查清單

執行測試時，請確認以下項目：

- [ ] 所有基本記帳功能測試通過
- [ ] 日期與時間處理正確
- [ ] 付款方式識別準確（包含所有暱稱）
- [ ] 品項與分類判斷符合規則
- [ ] 自然語句處理流暢
- [ ] 對話意圖正確識別
- [ ] 錯誤處理友善清晰

---

**更新日期**：2025-11-15
**版本**：v1 MVP Test Cases
